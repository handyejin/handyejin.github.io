---
layout: post
title: AWS RDS 및 Aurora 보안, RDS 프록시
date: 2024-08-16
category: AWS
---

# AWS

> AWS DVA-C02 시험 공부 과정을 블로그에 기록하고자 한다!! <br>
> 강의는 [udemy](https://www.udemy.com/share/105Hxw3@0cQdz1131EH9l6miYRGC7Z2Im8bmTMdAo7U-M_IUQA0101eYlVeFerKpk6CkYQwlDA==/) 강의를 참고하였다.

<br>

# RDS 및 Aurora 보안
- 미사용 데이터
  - 데이터베이스를 처음 시작할 때, KMS를 사용하여 마스터와 복제본을 암호화한다. 
  - 마스터 데이터베이스를 암호화 하지 못한 경우, 읽기 전용 복제본이 암호화될 수 없다. 
  - 암호화되지 않은 기존 데이터베이스를 암호화하려면, 암호화되지 않은 데이터베이스에서 스냅샷을 가져온 다음, 해당 데이터베이스 스냅샷을 암호화한 데이터베이스로 복원해야한다.
- 전송중 암호화
    - 클라이언트와 데이터베이스간의 암호화
    - aws의 TLS루트 인증서를 사용해야한다.
- IAM 데이터베이스 인증
  - IAM 역할이 있는 경우, 사용자 이름과 암호가 아닌 IAM 역할을 직접 사용하여 데이터베이스에 인증할 수 있다. 
- 보안그룹
  - 데이터베이스에 대한 엑세스 제어
-  RDS와 Aurora는 SSH 엑세스를 갖고 있지 않다. (관리형 서비스이기 때문)
  - 단 AWS의 RDS Custom서비스를 사용하는 경우는 예외이다.
- 감사 로그가 필요한 경우 감사로그를 활성화하여 쿼리와 데이터베이스 상태를 파악할 수 있다. 하지만 시간이 지나면 사라지기 때문에 Cloud watch 로그 서비스에 전송하면 된다. 

# RDS 프록시
- RDS의 완전 관리형 데이터베이스 프록시를 VPC에 배포할 수 있다.
- AWS RDS 프록시를 사용하면 애플리케이션이 데이터베이스로 설정된 데이터베이스 연결을 풀링하고 공유할 수 있다. 즉 모든 애플리케이션을 데이터베이스 인스턴스가 아니라 프록시에 연결한다. 
  - RDS프록시에 연결함으로써 RDS 데이터베이스 인스턴스에 연결이 많은 경우 CPU, RAM등 데이터베이스 리소스에 대한 스트레스를 줄여서 효율성을 향상해준다. 그리고 열린 연결과 데이터베이스에 대한 시간 초과를 최소화한다.
- RDS 프록시는 서버리이다.
- 오토 스케일링이며 가용성이 높다. 장애 조치 시간이 66% 줄어들 수 있다. 
- Mysql, Postgresql, mariadb, aurora를 지원한다.
- 데이터베이스의 IAM인증을 시행하고 자격증명을 Secrets Manager 서비스에 안전하게 저장한다. 
- 프록시에 공개적으로 엑세스 할 수 없다. VPC에서만 엑세스 할 수 있다. 

![alt text](\public\img\aws17-1.png){: width=" 500ß" height ="30" }