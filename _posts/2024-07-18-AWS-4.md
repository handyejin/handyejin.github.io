---
layout: post
title: EC2 기초 (EC2, 보안그룹, SSH 접속, 구매 옵션)
date: 2024-07-19
category: AWS
---

# AWS

> AWS DVA-C02 시험 공부 과정을 블로그에 기록하고자 한다!! <br>
> 강의는 [udemy](https://www.udemy.com/share/105Hxw3@0cQdz1131EH9l6miYRGC7Z2Im8bmTMdAo7U-M_IUQA0101eYlVeFerKpk6CkYQwlDA==/) 강의를 참고하였다.

<br>

## Amazon EC2
- Elastic Compute Cloud의 약자로 infrastructure 서비스
- 다양한 기능을 제공한다. 
  - EC2 인스턴스: 가상 머신 임대:
  - EBS 볼륨: 가상 드라이브에 데이터 저장
  - ELB: 여러 머신에 로드 분배
  - ASG: 서비스 확장

## EC2 설정 옵션
- 운영체제: Linux, Windows, Mac
- CPU: 컴퓨터 성능과 코어 수
- RAM: 랜덤 엑세스 메모리, RAM 용량
- 스토리지 용량
  - 네트워를 통해 연결되는 스토리지: EBS & EFS)
  - 하드웨어에 연결되는 스토리지: EC2 Instance Store
- 네트워크 유형
- 방화벽 규칙 (보안 규칙)
- 사용자 데이터
  - 처음 인스턴스가 시작할 때 부트 스크래핑

# 사용자 데이터
- 인스턴스를 부트스크래핑 가능함
- 부트스크래핑: 머신을 시작할 때 명령어를 실행하는 것
- 처음 시작할 때 한번만 실행한다.
- 업데이터 설치, 소프트웨어 설치, 파일 다운로드 등등 작성 가능
- 루트 관리자 권한으로 명령어를 실행하게 됨(sudo)


# 웹사이트 실습을 위한 EC2 생성

#### 키페어 생성
![alt text](\public\img\aws4-3.png){: width="500" height ="300" }
- 윈도우 7, 8이 아니면 pem으로 생성한다. 

#### 사용자 데이터 작성
![alt text](\public\img\aws4-2.png){: width="400" height ="300" }

#### 인스턴스 생성
![alt text](\public\img\aws4-4.png){: width="800" height ="550" }

#### EC2로 띄어진 웹사이트
![alt text](\public\img\aws4-5.png){: width="800" height ="550" }
- 웹 사이트 내용은 사용자 데이터에서 작성한 내용이다.

# EC2 인스턴스 유형
- 명명 규칙
  - 예) m5.2xlarge
    - m: 인스턴스 클래스
    - 5: 인스턴스 세대
    - 2xlarge: 인스턴스 클래스의 크기, 크기가 클수록 더 많은 메모리와 CPU를 갖게됨

### 범용 인스턴스
- 웹서버나 코드 저장소같은 다양한 작업에 적합

### 컴퓨팅 최적화 인스턴스
- 고성능을 요구하는 컴퓨터 집약적인 작업에 최적화된 인스턴스
- 사용 사례
  - 일부 데이터의 일괄처리
  - 미디어 크랜스코딩 작업
  - HPC
  - 머신러닝
  - 전용 게임 서버
- C로 시작하는 이름을 갖고 있음

### 메모리 최적화 인스턴스
- 메모리에서 대규모 데이터 셋을 처리하는 유형의 작업에 빠른 성능을 제공한다.
- 사용 사례
  - 고성능의 관계형/비관계형 데이터베이스
  - 분산 웹스케일 캐시 저장소
  - BI에 적합한 인메모리 데이터베이스
  - 대규모 비정형이 실시간 처리를 담당하는 애플리케이션
  
### 스토리지 최적화 인스턴스
- 로컬 스토리지에서 대규모의 데이터셋에 높은 순차 읽기/쓰기 액세스 할 때 적합한 인스턴스
- 사용 사례
  - 고주파 온라인 트랜잭션 시스템
  - 관계형, 비관계형 데이터베이스
  - 데이터 웨어하우징 애플리케이션
  - 분산 파일 시스템

![alt text](\public\img\aws4-1.png){: width="800" height ="550" }

# 보안그룹
- AWS에서 네트워크 보안을 실현하는 기능
- 인바운드, 아웃바운드 트랙픽을 제어한다.
- 보안 규칙은 컴퓨터가 위치한 IP주소를 참조하거나 다른 보안그룹을 참조할 수 있다. 
- EC2 인스턴스에 대한 방화벽 역할을 한다.
  - 포트에 대한 엑세스 관리
  - 허용된 IP범위인지 확인한다.

#### 보안그룹에 관하여 알아두면 좋은 지식
- 여러 인스턴스에 연결 가능하다.
- 리전이나 특정 VPC에 고정된다.
- 보안그룹은 EC2외부에 있어서 트래픽이 차단되면 EC2인스턴스는 이를 확인할 수 없다. 
- 개발자는 SSH전용으로 별도의 보안그룹을 관리하는것이 좋다. 
  - SSH 액세스는 복잡하고 제대로 이뤄졌는지 확인이 필요하므로
- 타임아웃이 발생하면 보안그룹 문제일 가능성이 높다!

#### 보안 그룹 포트
- 22 = SSH:  리눅스에서 ec2접속 
- 21 = FTP: 파일 공유에 파일 업로드
- 22 = SFTP: ssh를 사용하는 파일 업로드
- 80 = HTTP: 보안이 적용되지 않은 웹 사이트에 접속
- 443 = HTTPS: 보안이 적용된 웹 사이트 접속
- 3389 = RDP: 윈도우 인스턴스에 로그인

# EC2 인스턴스 접속(SSH)
![alt text](\public\img\aws4-6.png){: width="800" height ="550" }

### 주의사항
- ssh로 접속하여 자격증명을 위해 aws configure에서 개인 정보를 입력하면 절대 안된다. 
- 누군가가 EC2 인스턴스에 접속을 해서 인스턴스에 입력된 자격 증명 정보를 회수 할 수 있다. 
![alt text](\public\img\aws4-7.png){: width="800" height ="550" }

- 따라서 IAM 역할을 이용하여 자격증명을 해야 한다!!
  - EC2에서 IAM 역할 수정을 통한 자격증명
  - ![alt text](\public\img\aws4-8.png){: width="600" height ="400" }

  - 결과확인
  - ![alt text](\public\img\aws4-9.png){: width="600" height ="400" }

# EC2인스턴스 구매 옵션
-  온디맨드 EC2 인스턴스
  - 연속적인 단기 워크로드
  - 원하는 시기에 사용한만큼 지불
- 예약 인스턴스
  - 장기 워크로드
  - 유연성 있는 인스턴스가 필요할 경우
  - 특정 인스턴스 속성을 예약한다. (1년 또는 3년)
  - 전환헌 예약 인스턴스
    - 인스턴스 유형을 변경 가능
- Savings Plans
  - 특정 사용량을 약정하여 지불
  - 장기 워크로드
  - 장기 사용에 따라 할인을 받을 수 있다. 
  - 초과하는 사용량은 온디매드 방식으로 지불한다. 
  - 유연성
    - 인스턴스 크기
    - OS
    - 테넌시(호스트, 전용, 기본 값)
- Spot 인스턴스
  - 아주 짧은 단기 워크로드
  - 가장 저렴하다
  - 언제든 인스턴스를 손실할 수 있고 신뢰성이 낮다.
  - 서비스가 종료되어도 복구 가능성이 높은곳에 유용
    - 배치 작업
    - 데이터 분석
    - 이미지 처리
    - 분산된 워크로드
  - 데이터 베이스에는 적합하지 않음
- 전용 호스트
  - EC2 인스턴스 용량을 가진 물리적 서버
  - 물리적 서버 전체 예약하고 인스턴스 배치를 제어할 수 있다. 
  - 규정 준수 요청사항이 있거나, 기존의 서버 결합 소프트웨어 라이선스를 사용해야 할 경우
  - 지불 방식
    - 온디맨드 
    - 예약 (1년 또는 3년)
  - 가장 비용이 비싼 옵션이다.
- 전용 인스턴스
  - 전용 하드웨어에서 실행되는 인스턴스로 물리적 서버와는 다르다. 
  - 인스턴스 배치를 제어할 수 없다. 
  - 전용 인스턴스는 사용자 하드웨어에 고유한 인스턴스를 갖는것이고 반면에 전용 호스트는 물리적 서버 자체에 액세스하여 저수준 하드웨어에 대한 가시성을 제공
- 용량 예약
  - 특정한  AZ용량을 원하는 예약 기간동안 온디맨드 인스턴스 예약 가능
  - 시간 약정이 없기 때문에 용량을 예약하거나 취소 할 수 있다. 
  - 인스턴스 실행 여부와 관계 없이 온디맨드 요금을 부과한다. 
  - 단기적의 연속적인 워크로드에 잘 맞다. 