---
layout: post
title: AWS 오토 스케일링 그룹(ASG)
date: 2024-08-09
category: AWS
---

# AWS

> AWS DVA-C02 시험 공부 과정을 블로그에 기록하고자 한다!! <br>
> 강의는 [udemy](https://www.udemy.com/share/105Hxw3@0cQdz1131EH9l6miYRGC7Z2Im8bmTMdAo7U-M_IUQA0101eYlVeFerKpk6CkYQwlDA==/) 강의를 참고하였다.

<br>
# 오토 스케일링 그룹
- 오토 스케일링의 목표는 스케일 아웃과 스케일 인이다.
    - 스케일 아웃: EC2 인스턴스를 추가해서 늘어난 로드에 맞추는 것이다.
    - 스케일 인: 줄어든 로드에 맞추기 위해서 EC2 인스턴스를 줄인다.
- 로드 밸런서와 연결할 수 있다. 
- 인스턴스가 비정상으로 여겨지면 이것을 종료하고 새 EC2 인스턴스를 만들어 대체한다.
- 무료이다.

![alt text](\public\img\aws14-1.png){: width="700" height ="80" }

#### 로드밸런서와 오토 스케일링
- ELB는 EC2 인스턴스의 상태를 확인해서 비정상이라고 여기면 ASG 가 인스턴스를 종료 시킬 수 있다. 
- 스케일 아웃되면 ELB가 새로운 인스턴스에도 트래픽을 보내 부하를 분산시킨다. 
- 따라서 로드밸런서와 오토스케일링 그룹을 함께 쓰면 유용하다.
![alt text](\public\img\aws14-3.png){: width="700" height ="80" }


#### 오토 스케일링 특징
- Launch Template
  - ASG에서 EC2 인스턴스를 시작하는 방법에 관한 정보가 있다. (AMI, 인스턴스 유형, 사용자 데이터, EBS볼륨 등등)

    ![alt text](\public\img\aws14-2.png){: width="200" height ="80" }
- ASG의 최소 크기, 최대 크기, 초기 용량과 스케일링 정책을 정의해야 한다.

#### CloudWatch 경보와 오토 스케일링
- CloudWatch경보를 기반으로 스케일링이 가능하다. 
- CloudWatch 경보의 기준은 평균 CPU를 관찰할 수 있는 지표나 원하는 사용자 지정 지표가 될수 있다.

![alt text](\public\img\aws14-4.png){: width="700" height ="80" }

# 스케일링 정책
- 동적 스케일링
  - 목표 추적이 있다. 
    - 설정이 간단하다.
    - 목표값을 설정하고 자동으로 ASG가 확장되거나 축소되어 메트릭을 설정 값으로 유지할 수 있다. 
- 예약 스케일링
  - 사용 패턴을 기반으로 스케일링을 예상할 수 있다. 
- 예측 스케일링
  - 지속적으로 부하를 옝측한 다음 미리 예약을 시작하는 경우
  - 반복적인 패턴이 있을 때 부하를 분석하고 예측치를 생성하여 예측치를 기반으로 스케일링을 한다.
  - 주기적인 데이터가 있는 경우에 유용하다. 

#### 스케일링 활용 메트릭
- CPU 활용도
- 타겟당 요청수
- 평균 네트워크 사용량
- 클라우드 와치에 설정된 사용자 정의 메트릭 기반

#### 스케일링 쿨다운
- 인스턴스 스케일링 작업 후 기본적으로 5분 쿨다운 시간에 들어간다.
- 쿨다운 시간동안 ASG는 인스턴스틑 추가되거나 종료되지 않는다. (메트릭 안정화를 위해)

# 인스턴스 새로고침
- 인스턴스 종료한다음 나타날 때까지 기다리는 대신 오토 스케일링 그룹의 고유 기능인 인스턴스 새로고침을 사용할 수 있다. 
- Auto Scaling 그룹 전체에 AMI 또는 사용자 데이터 스크립트 배포. 변경 내용이 포함된 새 시작 템플릿을 생성한 다음 인스턴스 새로 고침을 사용하여 업데이트를 즉시 배포할 수 있다.