---
layout: post
title: AWS IAM
date: 2024-06-27
category: AWS
---

# AWS

> AWS DVA-C02 시험 공부 과정을 블로그에 기록하고자 한다!! <br>
> 강의는 [udemy](https://www.udemy.com/share/105Hxw3@0cQdz1131EH9l6miYRGC7Z2Im8bmTMdAo7U-M_IUQA0101eYlVeFerKpk6CkYQwlDA==/) 강의를 참고하였다.

<br>

## AWS IAM
- IAM은 리소스에 대한 액세스를 안전하게 제어할 수 있는 웹 서비스이다.
- AWS 계정을 생성할 때는 해당 계정의 모든 AWS 서비스 및 리소스에 대한 완전한 액세스 권한이 있는 단일 로그인 ID(루트 사용자)로 시작한다.
- 하지만 루트 계정을 사용하지 않는건 좋지 않은 방법이기 때문에 IAM을 사용해서 권한을 부여하여 사용해야한다.


## IAM 정책 및 권한
- 사용자와 그룹은 JSON형식으로 된 정책을 통해 권한을 부여받는다.
- 비용/보안 문제로 인해서 최소한 필요한 권한만 생성해야한다.

## IAM 정책 구성
![alt text](\public\img\aws2-2.png){: width="400" height ="200" }
- Version: IAM 정책 버전으로 '2012-10-17'를 사용하면 된다.
- ID: 정책 ID
- Statement: 권한 부여 규칙의 나열
  - SID: 문장 식별자
  - effect: 명시된 정책에 대한 허용 혹은 차단
  - Principal: 접근을 허용/차단 하고자 하는 대상
  - Action: 허용/차단하고자 하는 접근 타입
  - Resource: 요청의 목적지가 되는 서비스
  - Condition: 명시된 조건이 유효하다고 판단될 수 있는 조건

## IAM MFA
- Multi Factor Authentication
- 비밀번호와 보안장치를 통해 로그인
- 만약 계정을 해킹 당해도 계정 침투 가능성이 줄어든다.

**장치 종류**
- 가상 MFA 장치
  - Google Authenticator
  - Authy
  - 사용자의 컴퓨터 USB 포트에 MFA 를 지원하는 물리적인 장치를 연결하는 경우
- Hardware Key Fob MFA Device
- 기타 하드웨어 MFA 디바이스
  - U2F 보안키처럼 물리적인 장치이긴 하지만 U2F 와는 다르게 컴퓨터에 연결하는 것이 아니고 사용자가 사용할 수 있도록 인증을 위한 여섯 자리 숫자 코드를 제공하는 MFA 장치


## AWS Access
1. AWS 관리 콘솔
2.  CLI
  - 명령줄 쉘에서 명령어를 이용하여 aws 서비스와 상호작용
  - 오픈소스
3. SDK
  - 소프트웨어 개발 키트
  - 프로그래밍을 통해서 aws 서비스에 접근할 수 있도록 해줌.
  - 애플리케이션 내에 내장되어있음
  - 다양한 프로그래밍 언어 지원
  - 예) Python의 Boto SDK

## IAM 역할
- IAM 역할은 AWS 서비스에 부여된 권한이다.  
- IAM 역할을 실제 사용자가 사용하는 것이 아니라 AWS 서비스가 사용하는것이다.
- 역할 종류
  - EC2 인스턴스 역할
  - 람다 함수 역할
  - CloudFormation 역할
- ![alt text](\public\img\aws2-3.png){: width="400" height ="200" }

## IAM 보안 도구
- IAM 자격 증명 보고서
  - 계정 수준에서 가능
  - 계정에 있는 사용자와 다양한 자격증명 상태를 포함
- IAM 액세스 관리자
  - 사용자 수준에서 가능
  - 사용자에게 부여된 서비스 권한과 해당 서비스에 마지막으로 엑세스한 시간이 보인다. 

## IAM 모범 사례
- 루트 계정은 AWS 계정을 설정할 때를 제외하고 설정하지 않는다. 
- 하나의 AWS사용자는 한명의 실제 사용자이다. (두명 이상이 하나의 AWS 계정을 나눠쓰지 않는다.)
- 사용자를 그룹에 넣어 해당 그룹에 권한을 부여할 수 있다. 
  - 그룹 수준에서 보안관리를 할 수 있다. 
- 비밀번호 정책을 강력하게 만들어야 한다. 
- MFA정책을 사용할 수 있으면 적극적으로 사용한다. 
- AWS서비스에 권한을 부여할때마다 역할을 만들고 사용해야 한다. 
- AWS를 프로그래밍 할 때마다 액세스 키를 만들어 사용해야 한다. (SDK/CLI)
- 계정의 권한을 감시할 때는 IAM 자격 증명 보고서와 IAM 엑세스 관리자를 이용한다.
- **절대로 IAM 사용자와 액세스 키를 공유하지 않는다!!!**

## IAM 공동 책임 모델
- AWS가 책임을 가지는 부분
  - AWS가 하는 모든것
    - 인프라, 글로벌 네트워크 보안
    - 설정, 제공하는 서비스의 취약점 분석
    - 컴플라이언스 
- 사용자가 책임을 가지는 부분
  - IAM
    - 사용자, 그룹, 역할, 정책, 정책 관리, 모니터링
    - MFA 활성화
    - 주기적인 키 변화
    - IAM 도구를 사용한 적합한 권한 부여
    - 접근 패턴 분석
    - 계정에 속한 권한 검토

# IAM 오답 정리
![alt text](\public\img\aws2-4.png){: width="500" height ="350" }
- IAM 사용자 그룹은 IAM 사용자만 속할 수 있다. 